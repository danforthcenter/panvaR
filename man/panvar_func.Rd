% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_panvar_func.r
\name{panvar_func}
\alias{panvar_func}
\title{panvar_func}
\usage{
panvar_func(
  vcf_file_path,
  phenotype_data = NULL,
  gwas_table_path = NULL,
  annotation_table_path = NULL,
  tag_snps = NULL,
  r2_threshold = 0.6,
  maf = 0.05,
  missing_rate = 0.1,
  window = 500000,
  pc_min = 5,
  pc_max = 5,
  specific_pcs = NULL,
  dynamic_correlation = FALSE,
  all.impacts = FALSE
)
}
\arguments{
\item{vcf_file_path}{Path to VCF file as a character string.}

\item{phenotype_data}{(Optional) Path (character string) to the phenotype table (TSV/CSV)  OR a data.table object. Required unless \code{gwas_table_path} is provided. The first column must contain genotype identifiers.}

\item{gwas_table_path}{(Optional) Path (character string) to a pre-computed GWAS results table (TSV/CSV). If provided, \code{phenotype_data} and PC-related arguments are ignored. Must contain 'CHROM', 'BP', and 'Pvalues' columns.}

\item{annotation_table_path}{(Optional) Path to the annotation table file (TSV/CSV). Must contain 'GENE' and 'Annotation' columns. Defaults to NULL.}

\item{tag_snps}{SNP or SNP's as character string or vector respectively}

\item{r2_threshold}{LD threshold, SNP's in LD with tag SNP below this threshold are excluded}

\item{maf}{Minor allele frequency to filter VCF before conducting GWAS. default = .05.}

\item{missing_rate}{SNP's with missing rate above this threshold will be removed before GWAS. default = .1.}

\item{window}{Number of base-pairs to add and subtract to create a region of physical space around the tag snp. Can be supplied as an integer of base pairs or as a charcter string with the suffix "kb" denoting kilobases e.g. "500kb".}

\item{pc_min}{Minimum number of principal components for use in the GWAS model. Integer.}

\item{pc_max}{Maximum number of principal components for use in the GWAS model. Integer.}

\item{specific_pcs}{Specific prinicipal component numbers to include in the GWAS model. Numeric vector.}

\item{dynamic_correlation}{Should dynamic correlation of PC's be used? If true, PC's between the minimum and maximum number of PC's are included in the GWAS model if they are siginificantly correlated with the phenotype at the \eqn{\alpha} = .001 level.}

\item{all.impacts}{Low impact snp's are omitted for better visualization by default. If all impacts is true, low impact snp's are included in the output.}
}
\value{
A named list
\itemize{
\item \code{plot}, a plot of the results of panvar.
\item \code{table}, a table of the output.
}
}
\description{
The main panvar function, runs the panvar program and optionally runs gwas if the user does not provide their own gwas output.
}
\examples{
# Using a pre-computed GWAS table
panvar_func(vcf_file_path = "<path_to_vcf_file>", gwas_table_path = "<path_to_gwas_table>", tag_snps = c("Chr_09:12456"))

# Using phenotype file path for de-novo GWAS
panvar_func(vcf_file_path = "<path_to_vcf_file>", phenotype_data = "<path_to_phenotype_data>", tag_snps = c("Chr_09:12456"))

}
